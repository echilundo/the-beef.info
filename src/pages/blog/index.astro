---
import type { CollectionEntry } from "astro:content";
import { BLOG } from "@consts";

export async function getStaticProps() {
  const posts = (await getCollection("blog"))
    .filter(post => !post.data.draft)
    .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
  const data = posts.map((post) => ({
    ...post,
    formattedDate: new Date(post.data.date).toLocaleDateString(),
  }));
  return { props: { posts: data } };
}
---

<Container>
  <div class="space-y-4">
    <div class="text-2xl font-semibold">Recent Posts</div>
    {posts.map((post) => (
      <div key={post.slug} class="animate">
        <Link href={`/blog/${post.slug}`}>
          <a class="hover:underline">{post.data.title}</a>
        </Link>
        <div class="text-sm">
          {post.formattedDate}
        </div>
      </div>
    ))}
  </div>
</Container>
